# –§–∏–Ω–∞–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ: –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ

### 1. –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–µ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–µ –æ—Ç–≤–µ—Ç—ã –≤–æ –≤—Å–µ—Ö —Ä–µ–∂–∏–º–∞—Ö ‚úÖ

#### Web Search (speed mode)
- **–î–ª–∏–Ω–∞**: 400-600 —Å–ª–æ–≤ minimum (–±—ã–ª–æ 200-400)
- **–ò—Å—Ç–æ—á–Ω–∏–∫–∏**: 3-5 –æ–±—ã—á–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –í–°–ï
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∞**: —Å–µ–∫—Ü–∏–∏ —Å markdown
- **–¶–∏—Ç–∞—Ç—ã**: inline citations [1], [2]
- **–°—Å—ã–ª–∫–∏**: markdown —Ñ–æ—Ä–º–∞—Ç `[title](url)`

#### Deep Search (balanced mode)
- **–î–ª–∏–Ω–∞**: 800-1200 —Å–ª–æ–≤ minimum (–±—ã–ª–æ 500-800)
- **–ò—Å—Ç–æ—á–Ω–∏–∫–∏**: 8-12 –æ–±—ã—á–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –í–°–ï
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∞**: well-organized sections
- **–¶–∏—Ç–∞—Ç—ã**: inline citations —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏
- **–°—Å—ã–ª–∫–∏**: markdown —Ñ–æ—Ä–º–∞—Ç `[title](url)`

#### Deep Research (quality mode)
- **–î–ª–∏–Ω–∞**: 1500-3000 —Å–ª–æ–≤ (–±—ã–ª–æ 1000-2000)
- **–ò—Å—Ç–æ—á–Ω–∏–∫–∏**: 15-20+ –æ—Ç –≤—Å–µ—Ö –∞–≥–µ–Ω—Ç–æ–≤
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∞**: comprehensive report —Å Introduction, sections, Conclusion
- **–¶–∏—Ç–∞—Ç—ã**: extensive inline citations
- **–°—Å—ã–ª–∫–∏**: markdown —Ñ–æ—Ä–º–∞—Ç `[title](url)`

### 2. –ö–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ ‚úÖ

#### Backend —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
**writer.py**:
```python
# Add sources section
final_answer += "\n\n## Sources\n\n"
for i, source in enumerate(unique_sources):
    final_answer += f"[{i+1}] [{source['title']}]({source['url']})\n"
```

#### Frontend —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥
**page.tsx**:
```tsx
<Markdown options={{
  overrides: {
    a: {
      component: ({ href, children, ...props }) => (
        <a
          href={href}
          target="_blank"
          rel="noopener noreferrer"
          className="text-primary hover:underline font-medium"
        >
          {children}
        </a>
      )
    }
  }
}}>
  {message.content}
</Markdown>
```

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ**: —Ü–∏—Ç–∞—Ü–∏–∏ [1], [2] –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –≤ –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∏

### 3. PDF —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ ‚úÖ

#### Backend endpoint
- **API**: `GET /api/chat/stream/{session_id}/pdf`
- **–§—É–Ω–∫—Ü–∏—è**: `generate_pdf()` –≤ chat_stream.py
- **–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä**: `markdown_to_pdf()` –≤ utils/pdf_generator.py
- **–§–æ—Ä–º–∞—Ç**: A4, clickable links, proper formatting
- **–•—Ä–∞–Ω–µ–Ω–∏–µ**: –æ—Ç—á–µ—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏ (session_reports) –¥–ª—è PDF –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

#### Frontend –∫–Ω–æ–ø–∫–∞
**page.tsx**:
```tsx
<Button onClick={async () => {
  await downloadPDF(currentSessionId);
}}>
  <Download /> PDF
</Button>
```

**–§—É–Ω–∫—Ü–∏—è**: `downloadPDF()` –≤ lib/api.ts
- –ü–æ–ª—É—á–∞–µ—Ç PDF blob
- –°–æ–∑–¥–∞–µ—Ç download link
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫–∞—á–∏–≤–∞–µ—Ç —Ñ–∞–π–ª

### 4. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ ‚úÖ

#### Streaming —Å–æ–±—ã—Ç–∏—è
**ResearchStreamingGenerator** –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–±—ã—Ç–∏—è –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ:

1. **init** - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Å—Å–∏–∏
2. **status** - —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å (—Å step: memory/search/scrape/summarize/synthesis)
3. **search_queries** - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–∏—Å–∫–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã
4. **source_found** - –∫–∞–∂–¥—ã–π –Ω–∞–π–¥–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ (–≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏)
5. **planning** - research plan –∏ topics
6. **research_start** - –Ω–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã –∫–∞–∂–¥–æ–≥–æ –∞–≥–µ–Ω—Ç–∞
7. **agent_todo** - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ todo –ª–∏—Å—Ç–∞ –∞–≥–µ–Ω—Ç–∞
8. **agent_note** - –∑–∞–º–µ—Ç–∫–∏ –∞–≥–µ–Ω—Ç–æ–≤
9. **finding** - findings –æ—Ç –∞–≥–µ–Ω—Ç–æ–≤
10. **supervisor_react** - –¥–µ–π—Å—Ç–≤–∏—è supervisor
11. **compression** - —Å–∂–∞—Ç–∏–µ findings
12. **report_chunk** - —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ (chunks –ø–æ 180-200 —Å–∏–º–≤–æ–ª–æ–≤)
13. **final_report** - –ø–æ–ª–Ω—ã–π –æ—Ç—á–µ—Ç
14. **done** - –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ

#### –ó–∞–¥–µ—Ä–∂–∫–∏ –¥–ª—è –ø–ª–∞–≤–Ω–æ—Å—Ç–∏
- `await asyncio.sleep(0.02)` –º–µ–∂–¥—É chunks –æ—Ç–≤–µ—Ç–∞
- –°–æ–±—ã—Ç–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Å—Ä–∞–∑—É –ø—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏, –Ω–µ –≤ –∫–æ–Ω—Ü–µ

#### Frontend –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
**ChatProgressPanel.tsx** –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:
- ‚úÖ –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å —Å –∏–∫–æ–Ω–∫–æ–π (loading/complete)
- ‚úÖ –¢–µ–∫—É—â–∏–π step (badge)
- ‚úÖ Search queries (badges)
- ‚úÖ Memory context (list —Å scores)
- ‚úÖ Research plan (markdown —Å topics)
- ‚úÖ Findings (cards)
- ‚úÖ Sources (–∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏)
- ‚úÖ Agent tasks (todos —Å —Å—Ç–∞—Ç—É—Å–∞–º–∏: pending/in_progress/done)
- ‚úÖ Agent notes (—Å URLs)

**–ê–Ω–∏–º–∞—Ü–∏–∏**:
- Spinner –¥–ª—è loading
- Pulse –¥–ª—è in_progress tasks
- –ü–ª–∞–≤–Ω–æ–µ –ø–æ—è–≤–ª–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- Tooltips –Ω–∞ hover –¥–ª—è –¥–µ—Ç–∞–ª–µ–π

### 5. –ù–µ—Ç –¥–æ–ª–≥–æ–≥–æ –æ–∂–∏–¥–∞–Ω–∏—è ‚úÖ

#### Web Search
```
Status: Rewriting query... ‚Üí 
Status: Generating search queries... ‚Üí
Status: Searching... (–¥–ª—è –∫–∞–∂–¥–æ–≥–æ query) ‚Üí
Status: Scraping... (–¥–ª—è –∫–∞–∂–¥–æ–≥–æ URL) ‚Üí
Status: Summarizing... (–¥–ª—è –∫–∞–∂–¥–æ–≥–æ source) ‚Üí
Status: Synthesizing answer... ‚Üí
Report chunks (–ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ) ‚Üí
Status: Answer ready ‚Üí
Done
```

#### Deep Search
```
Status: Rewriting query... ‚Üí
Search queries (–ø–æ–∫–∞–∑–∞–Ω—ã) ‚Üí
Status: Searching... (iterations 1-6) ‚Üí
Sources found (–≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏) ‚Üí
Status: Scraping... ‚Üí
Status: Summarizing... ‚Üí
Status: Synthesizing answer... ‚Üí
Report chunks (–ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ) ‚Üí
Done
```

#### Deep Research
```
Status: Searching memory... ‚Üí
Status: Running deep search... ‚Üí
Status: Analyzing query... ‚Üí
Planning (–ø–ª–∞–Ω –ø–æ–∫–∞–∑–∞–Ω) ‚Üí
Status: Creating 4 agents... ‚Üí
Status: Executing agents... ‚Üí
Research start (–¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–≥–µ–Ω—Ç–∞) ‚Üí
Source found (–≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏) ‚Üí
Agent todos (–æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è) ‚Üí
Agent notes (–ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è) ‚Üí
Findings (–ø–æ –º–µ—Ä–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–¥–∞—á) ‚Üí
Supervisor reviewing... ‚Üí
(—Ü–∏–∫–ª –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è) ‚Üí
Status: Compressing findings... ‚Üí
Status: Generating final report... ‚Üí
Report chunks (–ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ) ‚Üí
Done
```

## üìä –ò—Ç–æ–≥–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

| –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ | Web Search | Deep Search | Deep Research | –°—Ç–∞—Ç—É—Å |
|-----------|------------|-------------|---------------|--------|
| –ë–æ–ª—å—à–æ–π —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–π –æ—Ç–≤–µ—Ç | 400-600 —Å–ª–æ–≤ | 800-1200 —Å–ª–æ–≤ | 1500-3000 —Å–ª–æ–≤ | ‚úÖ |
| –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤—Å–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ | 3-5 –≤—Å–µ | 8-12 –≤—Å–µ | 15-20+ –≤—Å–µ | ‚úÖ |
| –ö–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏ | [title](url) | [title](url) | [title](url) | ‚úÖ |
| –¶–∏—Ç–∞—Ü–∏–∏ –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã | [1]‚Üílink | [1]‚Üílink | [1]‚Üílink | ‚úÖ |
| PDF —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ |
| –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å | ‚úÖ 8 events | ‚úÖ 12 events | ‚úÖ 20+ events | ‚úÖ |
| –ù–µ—Ç –¥–æ–ª–≥–æ–≥–æ –æ–∂–∏–¥–∞–Ω–∏—è | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ |
| Streaming chunks | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ |

## üéØ –ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. –£–≤–µ–ª–∏—á–µ–Ω–∞ –¥–ª–∏–Ω–∞ –æ—Ç–≤–µ—Ç–æ–≤
- Speed: 200-400 ‚Üí 400-600 words
- Balanced: 500-800 ‚Üí 800-1200 words
- Quality: 1000-2000 ‚Üí 1500-3000 words

### 2. –£–±—Ä–∞–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- –ë—ã–ª–æ: `unique_sources[:10]`
- –°—Ç–∞–ª–æ: –≤—Å–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è
- `sources_limit`: 8 ‚Üí 20

### 3. –£–≤–µ–ª–∏—á–µ–Ω max_tokens
- `chat_model_max_tokens`: 2048 ‚Üí 8192 (–æ–±–Ω–æ–≤–ª–µ–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º)

### 4. –£–ª—É—á—à–µ–Ω—ã –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ LLM
- –Ø–≤–Ω–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ "USE ALL sources"
- "Don't just pick a few"
- "Synthesize from each source"

### 5. Streaming —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ
- –°–æ–±—ã—Ç–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Å—Ä–∞–∑—É
- Chunks —Å sleep(0.02) –º–µ–∂–¥—É –Ω–∏–º–∏
- –§—Ä–æ–Ω—Ç–µ–Ω–¥ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

## ‚úÖ –í—Å–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç

- ‚úÖ –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–µ –±–æ–ª—å—à–∏–µ –æ—Ç–≤–µ—Ç—ã –≤–æ –≤—Å–µ—Ö —Ä–µ–∂–∏–º–∞—Ö
- ‚úÖ –í—Å–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é
- ‚úÖ –ö–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏ (markdown + frontend —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥)
- ‚úÖ –ö–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–µ —Ü–∏—Ç–∞—Ü–∏–∏ (–∞–≤—Ç–æ–∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è [1]‚Üílink)
- ‚úÖ PDF –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ
- ‚úÖ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å –±–µ–∑ –¥–æ–ª–≥–æ–≥–æ –æ–∂–∏–¥–∞–Ω–∏—è
- ‚úÖ Streaming chunks –¥–ª—è –ø–ª–∞–≤–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è

**–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!**

